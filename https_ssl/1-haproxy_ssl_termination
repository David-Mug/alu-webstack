# Nginx SSL Termination Configuration
# Equivalent to HAproxy SSL termination setup
# This configuration listens on port 443, terminates SSL, and forwards to backend servers

# Backend web servers
upstream web-backend {
    server 34.203.40.73:80;
    server 13.221.144.42:80;
}

# HTTP to HTTPS redirect
server {
    listen 80 default_server;
    listen [::]:80 default_server;
    server_name kezamegane.tech www.mdavi.tech;
    return 301 https://$server_name$request_uri;
}

# HTTPS server with SSL termination
server {
    listen 443 ssl http2 default_server;
    listen [::]:443 ssl http2 default_server;
    server_name mdavi.tech www.mdavi.tech;

    # SSL Certificate paths
    ssl_certificate /etc/letsencrypt/live/mdavi
